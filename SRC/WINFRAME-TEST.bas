

10 REM === PROG INIT START ===
20 REM INIT SCREEN TO MODE 0 & CLEAR
30 SCREEN 0 : CLS

40 REM SCREEN WIDTH AND HEIGHT
50 SW=80 : SH=60 

60 REM FOREGROUND AND BACKGROWN COLORS
70 FC=1 : BC=0

80 REM CREATE THE ARG and RETURN SCRATCH ARRAYS
90 DIM AN(10) : DIM AS$(0)

1000 REM === START INIT UTILITIES ===
1010 REM INIT ERROR UTIL
1020 GOSUB 50110


1030 REM INIT WIN FRAME UTIL
1040 GOSUB 51110
1050 REM === END INIT UTILITIES ===

1200 REM === START TEST ===
1210 AN(0)=1  : REM WINDOW START COL
1220 AN(1)=1  : REM WINDOW START ROW
1230 AN(2)=40 : REM WINDOW WIDTH
1240 AN(3)=30 : REM WINDOWN HEIGHT
1250 AN(4)=FC : REM FOREGROUND COLOR
1260 AN(5)=BC : REM BACKGROUND COLOR
1270 AN(6)=1  : REM ROUNDED CORNERS
1280 AS$(0)="TEST WINDOW" : REM WINDOWN TITLE
1290 GOSUB 51200
1300 IF ER<>0 THEN PRINT"WINDOW ERROR ";ER;": ";ER$:END
1310 END    

51000 REM === START WINDOW FRAME LIBRARY === 
51001 REM Draws a bordered window using PETSCII glyphs with an optional title 
51002 REM string.  Can draw windows with either a square or a rounded corner.
51003 REM 
51004 REM Variables Defined :   
51005 REM   WD() - "Window Decorations"  -- petscii glyphs
51006 REM 
51007 REM External Variables Used : 
51008 REM   ER%, ER$
51009 REM 

51100 REM === PUBLIC INTERFACES ==
51110 GOSUB 51200 : RETURN : REM WIN_FRAME_INIT
51120 GOSUB 51300 : RETURN : REM DRAW_WINDOW_FRAME 

51200 REM === WIN_FRAME_INIT ===
51201 REM ===   : INITIALIZE WD() GLYPHS
51201 DIM WD(12)   
51202 WD(0)  = 176 : REM SQUARE TOP LEFT CORNER
51203 WD(1)  = 117 : REM ROUNDED TOP LEFT CORNER
51204 WD(2)  = 174 : REM SQUARE TOP RIGHT CORNER
51205 WD(3)  = 105 : REM ROUNDED TOP RIGHT CORNER
51206 WD(4)  = 173 : REM SQUARE BOTTOM LEFT CORNER
51207 WD(5)  = 106 : REM ROUNDED BOTTOM LEFT CORNER
51208 WD(6)  = 189 : REM SQUARE BOTTOM RIGHT CORNER
512O9 WD(7)  = 107 : REM ROUNDED BOTTOM RIGHT CORNER
51210 WD(8)  = 125 : REM VERTICAL EDGE
51211 WD(9)  =  99 : REM HORIZONTAL EDGE
51212 WD(10) = 171 : REM JOIN HORIZONTAL TO LEFT VERTICAL
51213 WD(11) = 179 : REM JOIN HORIZONTAL TO RIGHT VERTICAL
51214 WD(12) = 166 : REM TITLE BAR FILL
51215 RETURN

51500 REM ========================
51510 REM 

1000 REM DRAW WINDOW USING AN(), AS$(), WD()
1005 ER=0:ER$=""
1010 X0=AN(0):Y0=AN(1):W=AN(2):H=AN(3)
1015 X1=X0+W-1:Y1=Y0+H-1:TW=W-2
1020 FG=AN(4):BG=AN(5):RC=AN(6)
1030 ER=0:ER$=""

1040 IF RC<>0 AND RC<>1 THEN ER=1:ER$="BAD CORNER TYPE":RETURN
1050 IF W<3 OR H<4 THEN ER=2:ER$="WINDOW TOO SMALL":RETURN
1060 IF FG<0 OR FG>15 OR BG<0 OR BG>15 THEN ER=3:ER$="BAD COLOR":RETURN

1070 COLOR FG,BG

1080 REM TOP BORDER
1090 Y=Y0:L=WD(0+RC):R=WD(2+RC):M=WD(9):GOSUB 3000

1100 REM TITLE ROW
1110 YT=Y0+1
1120 IF YT<1 OR YT>SH THEN 1270

1130 T$=AS$(0)
1140 IF LEN(T$)>TW THEN T$=LEFT$(T$,TW)

1150 REM BUILD TITLE+SPACE+FILL STRING
1160 FI=TW-LEN(T$)
1170 T1$=T$+" "
1180 FI=FI-1
1190 IF FI>0 THEN FOR I=1 TO FI:T1$=T1$+CHR$(WD(12)):NEXT I

1200 REM LEFT TITLE BORDER (VERTICAL)
1210 X=X0
1220 IF X>=1 AND X<=SW THEN LOCATE YT,X:PRINT CHR$(WD(8));

1230 FOR I=1 TO TW
1240 X=X0+I
1250 IF X>=1 AND X<=SW THEN C$=MID$(T1$,I,1):LOCATE YT,X:PRINT C$;
1260 NEXT I

1265 X=X1
1266 IF X>=1 AND X<=SW THEN LOCATE YT,X:PRINT CHR$(WD(8));

1270 REM TITLE SEPARATOR ROW
1280 Y=Y0+2:L=WD(10):R=WD(11):M=WD(9):GOSUB 3000

1290 REM SIDE BORDERS ONLY
1300 FOR Y=Y0+3 TO Y1-1
1310 IF Y<1 OR Y>SH THEN 1360
1320 X=X0
1330 IF X>=1 AND X<=SW THEN LOCATE Y,X:PRINT CHR$(WD(8));
1340 X=X1
1350 IF X>=1 AND X<=SW THEN LOCATE Y,X:PRINT CHR$(WD(8));
1360 NEXT Y

1370 REM BOTTOM BORDER
1380 Y=Y1:L=WD(4+RC):R=WD(6+RC):M=WD(9):GOSUB 3000

1390 RETURN

3000 REM DRAW HORIZONTAL LINE AT Y WITH L,R,M CHARS
3010 IF Y<1 OR Y>SH THEN RETURN
3020 FOR X=X0 TO X1
3030 IF X<1 OR X>SW THEN 3080
3040 IF X=X0 THEN C=L:GOTO 3070
3050 IF X=X1 THEN C=R:GOTO 3070
3060 C=M
3070 LOCATE Y,X:PRINT CHR$(C);
3080 NEXT X
3090 RETURN
