5 CLS
10 SW=80:SH=60
20 DIM AN(10)
30 DIM WD(12)
40 DIM AS$(0)
45 ER=0:ER$=""

50 REM INITIALIZE WD() GLYPHS
60 WD(0)=176 : REM SQUARE TOP LEFT CORNER
70 WD(1)=117 : REM ROUNDED TOP LEFT CORNER
80 WD(2)=174 : REM SQUARE TOP RIGHT CORNER
90 WD(3)=105 : REM ROUNDED TOP RIGHT CORNER
100 WD(4)=173 : REM SQUARE BOTTOM LEFT CORNER
110 WD(5)=106 : REM ROUNDED BOTTOM LEFT CORNER
120 WD(6)=189 : REM SQUARE BOTTOM RIGHT CORNER
130 WD(7)=107 : REM ROUNDED BOTTOM RIGHT CORNER
140 WD(8)=125 : REM VERTICAL EDGE
150 WD(9)= 99 : REM HORIZONTAL EDGE
160 WD(10)=171: REM JOIN HORIZONTAL TO LEFT VERTICAL
170 WD(11)=179: REM JOIN HORIZONTAL TO RIGHT VERTICAL
180 WD(12)=166: REM TITLE BAR FILL

190 REM TEST WINDOW PARAMETERS (FULL SCREEN)
200 AN(0)=1:AN(1)=1
210 AN(2)=80:AN(3)=60
220 AN(4)=1:AN(5)=0
230 AN(6)=0
235 ER=0:ER$=""
240 AS$(0)="FULL SCREEN WINDOW"
250 GOSUB 1000
255 IF ER<>0 THEN PRINT"WINDOW ERROR ";ER;": ";ER$:END
260 END

1000 REM DRAW WINDOW USING AN(), AS$(), WD()
1010 X0=AN(0)
1020 Y0=AN(1)
1030 W =AN(2)
1040 H =AN(3)
1050 FG=AN(4)
1060 BG=AN(5)
1070 RC=AN(6)

1080 ER=0:ER$=""

1090 IF RC<>0 AND RC<>1 THEN ER=1:ER$="BAD CORNER TYPE":RETURN
1100 IF W<3 OR H<4 THEN ER=2:ER$="WINDOW TOO SMALL":RETURN
1110 IF FG<0 OR FG>15 OR BG<0 OR BG>15 THEN ER=3:ER$="BAD COLOR":RETURN

1120 COLOR FG,BG

1130 REM TOP BORDER
1140 Y=Y0
1150 FOR X=X0 TO X0+W-1
1160 IF X<1 OR X>SW OR Y<1 OR Y>SH THEN 1230
1170 IF X=X0 THEN C=WD(0+RC):GOTO 1220
1180 IF X=X0+W-1 THEN C=WD(2+RC):GOTO 1220
1190 C=WD(9)
1220 LOCATE Y,X:PRINT CHR$(C);
1230 NEXT X

1240 REM TITLE ROW
1250 YT=Y0+1
1260 IF YT<1 OR YT>SH THEN 1540

1270 TW=W-2
1280 T$=AS$(0)
1290 IF LEN(T$)>TW THEN T$=LEFT$(T$,TW)

1300 REM BUILD TITLE+SPACE+FILL STRING
1310 FI=TW-LEN(T$)
1320 T1$=T$+" "
1330 FI=FI-1
1340 IF FI>0 THEN FOR I=1 TO FI:T1$=T1$+CHR$(WD(12)):NEXT I

1350 REM LEFT TITLE BORDER (VERTICAL)
1360 X=X0
1370 IF X>=1 AND X<=SW THEN LOCATE YT,X:PRINT CHR$(WD(8));

1380 FOR I=1 TO TW
1390 X=X0+I
1400 IF X<1 OR X>SW THEN 1450
1410 C$=MID$(T1$,I,1)
1420 LOCATE YT,X:PRINT C$;
1450 NEXT I

1460 X=X0+W-1
1470 IF X>=1 AND X<=SW THEN LOCATE YT,X:PRINT CHR$(WD(8));

1540 REM TITLE SEPARATOR ROW
1550 YS=Y0+2
1560 IF YS<1 OR YS>SH THEN 1710
1570 FOR X=X0 TO X0+W-1
1580 IF X<1 OR X>SW THEN 1630
1590 IF X=X0 THEN C=WD(10):GOTO 1620
1600 IF X=X0+W-1 THEN C=WD(11):GOTO 1620
1610 C=WD(9)
1620 LOCATE YS,X:PRINT CHR$(C);
1630 NEXT X

1710 REM SIDE BORDERS ONLY (NO INTERIOR CLEARING)
1720 FOR Y=Y0+3 TO Y0+H-2
1730 IF Y<1 OR Y>SH THEN 1880
1740 FOR X=X0 TO X0+W-1
1750 IF X<1 OR X>SW THEN 1870
1760 IF X=X0 OR X=X0+W-1 THEN C=WD(8):GOTO 1850
1770 GOTO 1870
1850 LOCATE Y,X:PRINT CHR$(C);
1870 NEXT X
1880 NEXT Y

1890 REM BOTTOM BORDER
1900 YB=Y0+H-1
1910 FOR X=X0 TO X0+W-1
1920 IF X<1 OR X>SW OR YB<1 OR YB>SH THEN 2000
1930 IF X=X0 THEN C=WD(4+RC):GOTO 1990
1940 IF X=X0+W-1 THEN C=WD(6+RC):GOTO 1990
1950 C=WD(9)
1990 LOCATE YB,X:PRINT CHR$(C);
2000 NEXT X

2010 RETURN
